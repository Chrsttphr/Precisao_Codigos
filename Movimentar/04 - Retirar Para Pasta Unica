Sub MoverArquivosParaPastaPrincipal()
    Dim pastaPrincipal As String
    Dim fso As Object
    Dim arquivo As String
    Dim dialog As FileDialog
    Dim subPasta As Object
    Dim pastaDestino As String
    Dim subPastaPath As String

    ' Seleciona a pasta principal
    Set dialog = Application.FileDialog(msoFileDialogFolderPicker)
    With dialog
        .Title = "Selecione a pasta principal"
        .AllowMultiSelect = False

        ' Verifica se o usuário selecionou uma pasta
        If .Show = -1 Then
            pastaPrincipal = .SelectedItems(1)
        Else
            MsgBox "Nenhuma pasta principal foi selecionada. Operação cancelada.", vbExclamation
            Exit Sub
        End If
    End With

    ' Inicializa o FileSystemObject
    Set fso = CreateObject("Scripting.FileSystemObject")

    ' Verifica se a pasta principal existe
    If Not fso.FolderExists(pastaPrincipal) Then
        MsgBox "A pasta principal não foi encontrada. Verifique o caminho.", vbExclamation
        Exit Sub
    End If

    ' Processa as subpastas dentro da pasta principal
    For Each subPasta In fso.GetFolder(pastaPrincipal).Subfolders
        subPastaPath = subPasta.Path ' Obtém o caminho da subpasta

        ' Move os arquivos PDF da subpasta para a pasta principal
        arquivo = Dir(subPastaPath & "\*.pdf")
        Do While arquivo <> ""
            ' Verifica se o arquivo já existe na pasta principal
            If Not fso.FileExists(pastaPrincipal & "\" & arquivo) Then
                fso.MoveFile Source:=subPastaPath & "\" & arquivo, Destination:=pastaPrincipal & "\" & arquivo
            Else
                MsgBox "O arquivo '" & arquivo & "' já existe na pasta principal e não será movido.", vbExclamation
            End If
            arquivo = Dir
        Loop
    Next subPasta

    MsgBox "Arquivos PDF movidos para a pasta principal.", vbInformation

    ' Libera os objetos
    Set fso = Nothing
    Set dialog = Nothing
End Sub

✅ O que a macro faz
Permite escolher a pasta principal
Abre uma caixa de diálogo (FileDialog) para que o usuário selecione a pasta onde os arquivos serão centralizados.

Inicializa o FileSystemObject (FSO)
Cria um objeto para manipular arquivos e pastas via VBA.

Verifica se a pasta principal existe
Se não existir, exibe mensagem e encerra a execução.

Percorre todas as subpastas da pasta principal
Para cada subpasta:

Obtém o caminho completo (subPastaPath).
Lista todos os arquivos PDF dentro dela usando Dir.

Move arquivos PDF para a pasta principal

Para cada arquivo encontrado:
Verifica se já existe na pasta principal.

Se não existir → Move o arquivo.
Se existir → Exibe mensagem informando que não será movido (evita sobrescrever).

Exibe mensagem final
Mostra:
"Arquivos PDF movidos para a pasta principal."

Libera objetos da memória
Define fso e dialog como Nothing.

✅ Para que serve
Centralizar todos os arquivos PDF que estão espalhados em subpastas dentro de uma pasta principal, mantendo a estrutura limpa.

✅ Benefícios
Automação: Evita mover manualmente arquivos de várias subpastas.
Segurança: Não sobrescreve arquivos existentes.
Rapidez: Faz em segundos o que levaria muito tempo manualmente.

⚠️ Pontos de atenção
Move apenas arquivos PDF.
Não remove subpastas, apenas os arquivos.
Se houver arquivos com o mesmo nome, eles não serão movidos (exibe aviso).
Não trata permissões (pastas protegidas podem gerar erro).
