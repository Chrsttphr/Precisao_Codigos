Sub MoverArquivosParaPastaPrincipal()
    Dim pastaPrincipal As String
    Dim fso As Object
    Dim arquivo As String
    Dim dialog As FileDialog
    Dim subPasta As Object
    Dim pastaDestino As String
    Dim subPastaPath As String

    ' Seleciona a pasta principal
    Set dialog = Application.FileDialog(msoFileDialogFolderPicker)
    With dialog
        .Title = "Selecione a pasta principal"
        .AllowMultiSelect = False

        ' Verifica se o usuário selecionou uma pasta
        If .Show = -1 Then
            pastaPrincipal = .SelectedItems(1)
        Else
            MsgBox "Nenhuma pasta principal foi selecionada. Operação cancelada.", vbExclamation
            Exit Sub
        End If
    End With

    ' Inicializa o FileSystemObject
    Set fso = CreateObject("Scripting.FileSystemObject")

    ' Verifica se a pasta principal existe
    If Not fso.FolderExists(pastaPrincipal) Then
        MsgBox "A pasta principal não foi encontrada. Verifique o caminho.", vbExclamation
        Exit Sub
    End If

    ' Processa as subpastas dentro da pasta principal
    For Each subPasta In fso.GetFolder(pastaPrincipal).Subfolders
        subPastaPath = subPasta.Path ' Obtém o caminho da subpasta

        ' Move os arquivos PDF da subpasta para a pasta principal
        arquivo = Dir(subPastaPath & "\*.pdf")
        Do While arquivo <> ""
            ' Verifica se o arquivo já existe na pasta principal
            If Not fso.FileExists(pastaPrincipal & "\" & arquivo) Then
                fso.MoveFile Source:=subPastaPath & "\" & arquivo, Destination:=pastaPrincipal & "\" & arquivo
            Else
                MsgBox "O arquivo '" & arquivo & "' já existe na pasta principal e não será movido.", vbExclamation
            End If
            arquivo = Dir
        Loop
    Next subPasta

    MsgBox "Arquivos PDF movidos para a pasta principal.", vbInformation

    ' Libera os objetos
    Set fso = Nothing
    Set dialog = Nothing
End Sub
