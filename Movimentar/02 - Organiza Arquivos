Sub DistribuirArquivos()
    Dim fs As Object
    Dim pastaMestre As String
    Dim pastaNF As String
    Dim pastaBoleto As String
    Dim pastaOutro As String
    Dim arquivo As Object
    Dim arquivoNome As String
    
    ' Defina as pastas aqui
    pastaMestre = "C:\Users\Raphaela\Desktop\Sped\MESTRA\"   ' Caminho para a pasta mestre
    pastaNF = "C:\Users\Raphaela\Desktop\Sped\NF\"           ' Caminho para a pasta NF
    pastaBoleto = "C:\Users\Raphaela\Desktop\Sped\BOLETO\"   ' Caminho para a pasta Boleto
    pastaOutro = "C:\Users\Raphaela\Desktop\Sped\RELATÓRIO\" ' Caminho para a pasta Outro

    Set fs = CreateObject("Scripting.FileSystemObject")
    
    ' Verifica se a pasta mestre existe
    If Not fs.FolderExists(pastaMestre) Then
        MsgBox "A pasta mestre não foi encontrada.", vbExclamation
        Exit Sub
    End If
    
    ' Verifica se as pastas de destino existem
    If Not fs.FolderExists(pastaNF) Then fs.CreateFolder(pastaNF)
    If Not fs.FolderExists(pastaBoleto) Then fs.CreateFolder(pastaBoleto)
    If Not fs.FolderExists(pastaOutro) Then fs.CreateFolder(pastaOutro)
    
    ' Percorre todos os arquivos na pasta mestre
    For Each arquivo In fs.GetFolder(pastaMestre).Files
        arquivoNome = fs.GetFileName(arquivo.Path)
        
        ' Verifica os prefixos dos nomes dos arquivos
        If UCase(Left(arquivoNome, 2)) = "NF" Then
            fs.MoveFile arquivo.Path, pastaNF & arquivoNome
        ElseIf UCase(Left(arquivoNome, 7)) = "BOLETO " Then ' Verifica "BOLETO " com espaço
            fs.MoveFile arquivo.Path, pastaBoleto & arquivoNome
        Else
            fs.MoveFile arquivo.Path, pastaOutro & arquivoNome
        End If
    Next arquivo

    MsgBox "Distribuição concluída.", vbInformation
End Sub

✅ O que a macro faz
Define as pastas principais
Configura quatro caminhos:

pastaMestre: Onde estão os arquivos originais.
pastaNF: Destino para arquivos com prefixo NF.
pastaBoleto: Destino para arquivos com prefixo BOLETO.
pastaOutro: Destino para arquivos que não se enquadram nos dois casos anteriores.

Cria objeto FileSystemObject (FSO)
Permite manipular arquivos e pastas via VBA.

Verifica se a pasta mestre existe
Se não existir, exibe mensagem e encerra a execução.

Verifica e cria pastas de destino
Se alguma das pastas de destino não existir, a macro cria automaticamente.

Percorre todos os arquivos da pasta mestre
Para cada arquivo:

Obtém o nome do arquivo (arquivoNome).
Verifica o prefixo:

Se começar com "NF" → Move para pastaNF.
Se começar com "BOLETO " (com espaço) → Move para pastaBoleto.
Caso contrário → Move para pastaOutro.

Exibe mensagem final
Mostra:
"Distribuição concluída."

✅ Para que serve
Organizar automaticamente arquivos em subpastas com base no prefixo do nome, garantindo separação por tipo (NF, BOLETO, outros).

✅ Benefícios
Automação: Evita mover manualmente dezenas ou centenas de arquivos.
Organização: Mantém arquivos classificados por categoria.
Rapidez: Faz em segundos o que levaria muito tempo manualmente.

⚠️ Pontos de atenção
Prefixos são verificados com UCase (maiúsculas), mas dependem de posição fixa:
NF → primeiros 2 caracteres.
BOLETO → primeiros 7 caracteres (inclui espaço).

Se houver variação no nome (ex.: “BOLETO123” sem espaço), não será reconhecido.
Move os arquivos (não copia). Se quiser copiar, troque MoveFile por CopyFile.
