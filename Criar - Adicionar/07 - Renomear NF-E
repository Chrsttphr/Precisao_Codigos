Sub RenomearArquivosNF()
    Dim pastaOrigem As String
    Dim fso As Object
    Dim pasta As Object
    Dim arquivo As Object
    Dim nomeAtual As String
    Dim novoNome As String
    Dim numeroNF As String
    Dim caminhoAtual As String
    Dim caminhoNovo As String
    Dim dialog As Object
    Dim posicaoNumero As Long
    
    ' Abrir janela para selecionar a pasta de origem
    Set dialog = Application.FileDialog(msoFileDialogFolderPicker)
    dialog.Title = "Selecione a pasta onde estão os arquivos PDF"
    
    ' Exibe a caixa de diálogo
    If dialog.Show = -1 Then
        pastaOrigem = dialog.SelectedItems(1)
    Else
        MsgBox "Nenhuma pasta foi selecionada. A macro será encerrada."
        Exit Sub
    End If
    
    ' Verificar se a pasta termina com "\"
    If Right(pastaOrigem, 1) <> "\" Then
        pastaOrigem = pastaOrigem & "\"
    End If
    
    ' Criar objeto FileSystemObject
    Set fso = CreateObject("Scripting.FileSystemObject")
    
    ' Atribuir a pasta a um objeto
    Set pasta = fso.GetFolder(pastaOrigem)
    
    ' Loop através de todos os arquivos na pasta
    For Each arquivo In pasta.Files
        ' Verifica se o arquivo é um PDF
        If LCase(fso.GetExtensionName(arquivo.Name)) = "pdf" Then
            nomeAtual = arquivo.Name
            
            ' Verifica se o nome já foi renomeado (contém o prefixo "NF-E")
            If InStr(nomeAtual, "NF-E") = 0 Then
                ' Encontra a posição dos últimos 10 números
                posicaoNumero = Len(nomeAtual) - 15
                
                ' Certifica-se de que a posição inicial é válida
                If posicaoNumero > 9 Then
                    ' Extrai os 9 dígitos antes dos últimos 10 números
                    numeroNF = Mid(nomeAtual, posicaoNumero - 6, 8)
                    
                    ' Constrói o novo nome no formato desejado
                    novoNome = "NF-E " & numeroNF & " - " & nomeAtual
                    
                    ' Constrói os caminhos completos
                    caminhoAtual = pastaOrigem & nomeAtual
                    caminhoNovo = pastaOrigem & novoNome
                    
                    ' Renomeia o arquivo
                    Name caminhoAtual As caminhoNovo
                End If
            End If
        End If
    Next arquivo
    
    MsgBox "Arquivos renomeados com sucesso!"
End Sub

✅ O que a macro faz
Solicita ao usuário a pasta de origem
Abre uma janela para selecionar a pasta onde estão os arquivos PDF.

Prepara o caminho e objetos necessários
Garante que o caminho da pasta termine com \.
Cria um objeto FileSystemObject para manipular arquivos e pastas.

Percorre todos os arquivos da pasta
Verifica se o arquivo é um PDF.
Ignora arquivos que já possuem o prefixo “NF-E” (para evitar renomear duas vezes).

Extrai parte do nome original para compor o novo nome
Calcula a posição dos dígitos que representam o número da nota fiscal.
Usa Mid para pegar 8 caracteres (supostamente o número da NF).
Constrói o novo nome no formato:
NF-E [NúmeroNF] - [NomeOriginal]

Renomeia o arquivo
Usa o comando Name para alterar o nome do arquivo no sistema.

Exibe mensagem final
“Arquivos renomeados com sucesso!”

✅ Para que serve
Essa macro é útil para padronizar nomes de arquivos de notas fiscais eletrônicas (NF-e), garantindo organização e fácil identificação. Por exemplo:
Adicionar um prefixo padrão.
Destacar o número da NF no início do nome.

✅ Benefícios
Automação: Evita renomear manualmente dezenas ou centenas de arquivos.
Padronização: Garante que todos os arquivos sigam o mesmo formato.
Rapidez: Faz em segundos o que levaria muito tempo manualmente.

Esse tipo de macro é muito usado em departamentos fiscais, contábeis e administrativos, onde há grande volume de documentos digitais que precisam ser organizados.
