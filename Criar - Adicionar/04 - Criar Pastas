Sub CriarPastasDeCelulasOuPastaExistente()
    Dim opcao As Integer
    Dim pastaBase As String
    Dim dlg As FileDialog
    Dim intervalo As Range
    Dim ws As Worksheet
    Dim celula As Range
    Dim novaPasta As String
    Dim pastaSelecionada As FileDialog
    Dim pastasSelecionadas As Collection
    Dim i As Long
    Dim pastaNova As String
    Dim fso As Object
    Dim pastaOrigem As String
    Dim pastaExistente As Variant

    ' Exibir a janela para selecionar a pasta base
    Set dlg = Application.FileDialog(msoFileDialogFolderPicker)
    With dlg
        .Title = "Selecione a pasta base"
        If .Show <> -1 Then
            MsgBox "Operação cancelada pelo usuário.", vbInformation
            Exit Sub
        End If
        pastaBase = .SelectedItems(1) & "\"
    End With

    ' Exibir opções ao usuário
    opcao = MsgBox("Escolha uma opção:" & vbCrLf & _
                   "Sim - Ler Listagem de Células" & vbCrLf & _
                   "Não - Selecionar Pastas Existentes", _
                   vbYesNoCancel + vbQuestion, "Opções")

    If opcao = vbCancel Then
        MsgBox "Operação cancelada pelo usuário.", vbInformation
        Exit Sub
    End If

    ' Opção 1: Ler Listagem de Células
    If opcao = vbYes Then
        ' Verificar se a planilha existe
        On Error Resume Next
        Set ws = ThisWorkbook.Sheets("Planilha1")
        On Error GoTo 0

        If ws Is Nothing Then
            MsgBox "A planilha 'HiperLink' não foi encontrada.", vbCritical
            Exit Sub
        End If

        ' Solicitar o intervalo
        On Error Resume Next
        Set intervalo = Application.InputBox("Selecione o intervalo de células:", "Selecionar Intervalo", Type:=8)
        On Error GoTo 0

        If intervalo Is Nothing Then
            MsgBox "Operação cancelada pelo usuário.", vbInformation
            Exit Sub
        End If

        ' Criar pastas com base no intervalo selecionado
        For Each celula In intervalo
            If Not IsEmpty(celula.Value) Then
                novaPasta = pastaBase & celula.Value
                If Dir(novaPasta, vbDirectory) = "" Then
                    MkDir novaPasta
                End If
            End If
        Next celula

    ' Opção 2: Selecionar Pastas Existentes
    ElseIf opcao = vbNo Then
        ' Inicializar a coleção para armazenar as pastas selecionadas
        Set pastasSelecionadas = New Collection

        ' Abrir o diálogo para selecionar múltiplas pastas
        Do
            Set dlg = Application.FileDialog(msoFileDialogFolderPicker)
            With dlg
                .Title = "Selecione uma pasta existente (ou clique Cancelar para finalizar)"
                If .Show = -1 Then
                    pastasSelecionadas.Add .SelectedItems(1)
                Else
                    Exit Do
                End If
            End With
        Loop

        ' Verificar se pelo menos uma pasta foi selecionada
        If pastasSelecionadas.Count = 0 Then
            MsgBox "Nenhuma pasta foi selecionada.", vbInformation
            Exit Sub
        End If

        ' Criar uma pasta com o mesmo nome em outra pasta base
        Set fso = CreateObject("Scripting.FileSystemObject")
        For Each pastaExistente In pastasSelecionadas
            pastaNova = pastaBase & fso.GetFileName(pastaExistente)
            If Dir(pastaNova, vbDirectory) = "" Then
                MkDir pastaNova
            End If
        Next pastaExistente
    End If

    MsgBox "Processo concluído!", vbInformation
End Sub

✅ O que a macro faz
Seleciona a pasta base
Abre uma janela para o usuário escolher a pasta onde as novas pastas serão criadas.

Pergunta ao usuário qual método usar:
Sim → Criar pastas com base em uma lista de nomes em células.
Não → Criar pastas com base em pastas já existentes (replicando seus nomes na pasta base).
Cancelar → Interrompe a execução.

Se a opção for “Ler Listagem de Células”:
Solicita ao usuário um intervalo de células que contém os nomes das novas pastas.
Para cada célula não vazia, cria uma pasta com esse nome dentro da pasta base (se não existir ainda).

Se a opção for “Selecionar Pastas Existentes”:
Permite ao usuário escolher múltiplas pastas existentes.
Para cada pasta selecionada, cria uma nova pasta na pasta base com o mesmo nome (sem copiar conteúdo, apenas cria a estrutura).

Finaliza com uma mensagem informando que o processo foi concluído.

✅ Para que serve
Essa macro é útil para organizar estruturas de diretórios rapidamente, seja:
Criando pastas a partir de uma lista (por exemplo, nomes de clientes, projetos ou meses).
Replicando a estrutura de nomes de pastas existentes em outro local.

✅ Benefícios
Agilidade: Evita criar pastas manualmente uma a uma.
Flexibilidade: Permite escolher entre nomes em células ou replicar pastas existentes.
Controle: Garante que não cria duplicatas (verifica se a pasta já existe).
