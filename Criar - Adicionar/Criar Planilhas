Sub MoverArquivosEspecificosParaPastaPrincipal()
    Dim pastaPrincipal As String
    Dim fso As Object
    Dim arquivo As String
    Dim subPastasSelecionadas As Collection
    Dim dialog As FileDialog

    ' Inicializa o FileSystemObject
    Set fso = CreateObject("Scripting.FileSystemObject")

    ' Inicializa o FileDialog para selecionar a pasta principal
    Set dialog = Application.FileDialog(msoFileDialogFolderPicker)
    With dialog
        .Title = "Selecione a pasta principal"
        .AllowMultiSelect = False
        
        ' Verifica se o usuário selecionou uma pasta
        If .Show = -1 Then
            pastaPrincipal = .SelectedItems(1)
        Else
            MsgBox "Nenhuma pasta principal foi selecionada. Operação cancelada.", vbExclamation
            Exit Sub
        End If
    End With

    ' Verifica se a pasta principal existe
    If Not fso.FolderExists(pastaPrincipal) Then
        MsgBox "A pasta principal não foi encontrada. Verifique o caminho.", vbExclamation
        Exit Sub
    End If

    ' Inicializa o FileDialog para selecionar subpastas
    Set dialog = Application.FileDialog(msoFileDialogFolderPicker)
    With dialog
        .Title = "Selecione as subpastas a serem processadas"
        .AllowMultiSelect = True

        ' Verifica se o usuário selecionou subpastas
        If .Show = -1 Then
            Set subPastasSelecionadas = New Collection
            Dim i As Integer
            For i = 1 To .SelectedItems.Count
                subPastasSelecionadas.Add .SelectedItems(i)
            Next i
        Else
            MsgBox "Nenhuma subpasta foi selecionada. Operação cancelada.", vbExclamation
            Exit Sub
        End If
    End With

    ' Processa as subpastas selecionadas
    Dim subPastaPath As Variant
    For Each subPastaPath In subPastasSelecionadas
        ' Verifica se a subpasta existe
        If fso.FolderExists(subPastaPath) Then
            ' Move arquivos PDF
            arquivo = Dir(subPastaPath & "\*.pdf")
            Do While arquivo <> ""
                fso.MoveFile Source:=subPastaPath & "\" & arquivo, Destination:=pastaPrincipal & "\" & arquivo
                arquivo = Dir
            Loop
        Else
            MsgBox "A subpasta '" & subPastaPath & "' não foi encontrada.", vbExclamation
        End If
    Next subPastaPath

    MsgBox "Arquivos PDF movidos com sucesso para a pasta principal.", vbInformation

    ' Libera os objetos
    Set fso = Nothing
    Set dialog = Nothing
End Sub
