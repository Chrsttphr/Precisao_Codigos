Sub SincronizarFiltros()
    Dim ws As Worksheet
    Dim tblBloco As ListObject
    Dim tblDescricao As ListObject
    Dim filtroBloco As String
    Dim campoFiltro As Integer
    Dim nomePlanilha As String
    Dim nomeColunaComum As String

    ' Defina o nome da planilha onde estão as tabelas
    nomePlanilha = "Planilha 1" ' Nome da sua planilha

    ' Tente definir a planilha
    On Error Resume Next
    Set ws = ThisWorkbook.Sheets(nomePlanilha)
    On Error GoTo 0

    ' Verifique se a planilha foi definida corretamente
    If ws Is Nothing Then
        MsgBox "A planilha '" & nomePlanilha & "' não foi encontrada.", vbCritical
        Exit Sub
    End If

    ' Defina as tabelas
    On Error Resume Next
    Set tblBloco = ws.ListObjects("Tabela 1")
    Set tblDescricao = ws.ListObjects("Tabela 2")
    On Error GoTo 0

    ' Verifique se as tabelas foram definidas corretamente
    If tblBloco Is Nothing Or tblDescricao Is Nothing Then
        MsgBox "Uma ou ambas as tabelas não foram encontradas na planilha.", vbCritical
        Exit Sub
    End If

    ' Verifique se o filtro está ativado na tabela Tabela 1
    On Error Resume Next
    filtroBloco = tblBloco.AutoFilter.Filters(1).Criteria1
    On Error GoTo 0

    ' Remove filtros existentes da tabela Tabela 2
    If tblDescricao.AutoFilter.FilterMode Then
        tblDescricao.AutoFilter.ShowAllData
    End If

    ' Verifique se o filtro está aplicado
    If filtroBloco <> "" Then
        ' Nome da coluna comum na tabela Tabela 2
        nomeColunaComum = "Coluna1" ' Substitua pelo nome real da coluna comum
        
        ' Verifique se a coluna comum existe na tabela Tabela 2
        On Error Resume Next
        campoFiltro = tblDescricao.ListColumns(nomeColunaComum).Index
        On Error GoTo 0
        
        If campoFiltro > 0 Then
            ' Aplica o filtro na tabela Tabela 2 com base no filtro da tabela Tabela 1
            tblDescricao.Range.AutoFilter Field:=campoFiltro, Criteria1:=filtroBloco
        Else
            MsgBox "A coluna '" & nomeColunaComum & "' não foi encontrada na tabela Tabela 2.", vbCritical
        End If
    End If
End Sub

✅O que a macro faz
Identifica a planilha e as tabelas
Define a planilha onde estão as tabelas (Planilha 1).
Localiza duas tabelas chamadas Tabela 1 e Tabela 2.

Verifica se tudo existe
Se a planilha ou as tabelas não forem encontradas, exibe uma mensagem de erro e interrompe.

Captura o filtro aplicado na primeira tabela
Verifica se existe um filtro ativo na Tabela 1 e pega o critério do primeiro filtro (coluna 1).

Remove filtros existentes na segunda tabela
Limpa qualquer filtro aplicado na Tabela 2 para evitar conflitos.

Aplica o mesmo filtro na segunda tabela
Usa uma coluna comum (definida como "Coluna1", mas pode ser alterada) para aplicar o mesmo critério de filtro na Tabela 2.
Se a coluna não existir, exibe uma mensagem de erro.

✅ Para que serve
Essa macro é útil quando você tem duas tabelas relacionadas e quer que os filtros aplicados em uma tabela sejam replicados na outra automaticamente. Por exemplo:
Uma tabela com blocos e outra com descrições detalhadas.
Ao filtrar um bloco na primeira tabela, a segunda tabela mostra apenas as descrições correspondentes.


✅ Benefícios
Agilidade: Evita aplicar filtros manualmente em várias tabelas.
Consistência: Garante que as tabelas exibam dados relacionados.
Automação: Reduz erros humanos em relatórios ou dashboards.
