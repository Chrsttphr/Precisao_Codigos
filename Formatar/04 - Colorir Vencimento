Sub AnalisarDatas()
    Dim ws As Worksheet
    Dim cell As Range
    Dim dataCol As Range
    Dim hoje As Date
    Dim ultimaLinha As Long
    Dim colunaDatas As String
    
    On Error GoTo Erro

    ' Definir a planilha ativa
    Set ws = ActiveSheet
    
    ' Solicitar ao usuário a coluna de datas
    colunaDatas = InputBox("Digite a letra da coluna que contém as datas (ex: A):", "Selecionar Coluna de Datas", "A")
    If colunaDatas = "" Then
        MsgBox "Nenhuma coluna foi selecionada. O código será encerrado.", vbExclamation
        Exit Sub
    End If
    
    ' Encontrar a última linha com dados na coluna especificada
    ultimaLinha = ws.Cells(ws.Rows.Count, colunaDatas).End(xlUp).Row
    
    ' Verificar se há dados na coluna
    If ultimaLinha < 2 Then
        MsgBox "Não há dados suficientes na coluna selecionada.", vbExclamation
        Exit Sub
    End If
    
    ' Definir o intervalo de datas
    Set dataCol = ws.Range(colunaDatas & "2:" & colunaDatas & ultimaLinha)
    
    ' Obter a data de hoje
    hoje = Date
    
    ' Limpar formatação anterior
    dataCol.Interior.ColorIndex = xlNone
    dataCol.Font.ColorIndex = xlAutomatic
    
    ' Loop através de cada célula na coluna de datas
    For Each cell In dataCol
        If IsDate(cell.Value) Then
            Select Case True
                Case cell.Value < hoje
                    ' Datas vencidas
                    cell.Interior.Color = RGB(255, 0, 0) ' Vermelho
                    cell.Font.Color = RGB(255, 255, 255) ' Branco
                Case cell.Value >= hoje + 1 And cell.Value <= hoje + 7
                    ' Datas prestes a vencer (nos próximos 7 dias)
                    cell.Interior.Color = RGB(255, 255, 0) ' Amarelo
                    cell.Font.Color = RGB(0, 0, 0) ' Preto
                Case cell.Value >= hoje
                    ' Datas no prazo
                    cell.Interior.Color = RGB(0, 255, 0) ' Verde
                    cell.Font.Color = RGB(0, 0, 0) ' Preto
            End Select
        End If
    Next cell
    
    MsgBox "Análise de datas concluída!", vbInformation
    Exit Sub
    
Erro:
    MsgBox "Ocorreu um erro: " & Err.Description, vbCritical
End Sub

✅ O que a macro faz
Solicita ao usuário a coluna de datas
Exibe uma caixa de entrada para que o usuário informe a letra da coluna onde estão as datas (ex.: A).

Identifica a última linha preenchida
Verifica até onde existem dados na coluna informada para definir o intervalo a ser analisado.

Valida se há dados suficientes
Se não houver pelo menos uma linha com dados, encerra a execução com uma mensagem.

Define o intervalo de análise
Cria um objeto Range com todas as células da coluna (a partir da linha 2 até a última linha).

Obtém a data atual
Armazena a data do sistema na variável hoje.

Remove formatações anteriores
Limpa cores de fundo e cores de fonte do intervalo antes de aplicar novas formatações.

Percorre cada célula do intervalo
Para cada célula que contém uma data válida:

Se a data for menor que hoje:
Marca como vencida → Fundo vermelho, texto branco.
Se a data estiver entre amanhã e 7 dias à frente:
Marca como prestes a vencer → Fundo amarelo, texto preto.
Se a data for hoje ou maior:
Marca como no prazo → Fundo verde, texto preto.

Exibe mensagem final
Mostra: "Análise de datas concluída!"

✅ Para que serve
Essa macro é útil para destacar visualmente prazos em uma planilha, permitindo identificar rapidamente:

Datas vencidas.
Datas próximas do vencimento.
Datas ainda dentro do prazo.

✅ Benefícios
Automação: Evita verificar manualmente cada data.
Clareza visual: Facilita a gestão de prazos.
Rapidez: Analisa centenas de linhas em segundos.
